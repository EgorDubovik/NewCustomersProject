import{r as l,a as c,j as w,m as p}from"./index-91d59c4a.js";const W=e=>{const s=e.appointmentTiles||[],t=e.daysArray||[],a=e.defaultAppointmentOpacity,i=e.defaultAppointmentBgColor,n=e.timesArray||[];e.totalDuration;const r=e.blockHeight||50,m=e.onAppointmentClick||null,d=e.setAppointmentStyle||null,o=l.useRef(null);l.useRef(0),l.useRef(0),l.useRef(!1),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(null),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(!1);const h=y=>{},g=()=>{},f=y=>{let T={backgroundColor:y.appointment.backgroundColor??i,inset:"1px",opacity:y.appointment.opacity??a},u={color:"#fff"},D={},b={};return d&&({extendedBackgroundStyles:D,extendedTitleStyle:b}=d(y.appointment)),T={...T,...D},u={...u,...b},{backgroundStyles:T,titleStyles:u}};return c("div",{className:"dates grid  w-full",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map((y,T)=>c("div",{className:"date pt-2 first:border-0 border-l dark:border-gray-600 border-gray-300",children:w("div",{className:"day-inner relative h-full",ref:o,children:[c("div",{className:"appointments-list overflow-hidden absolute h-full left-0 top-0 right-0",onMouseUp:g,onMouseMove:h,children:s[T]&&s[T].map((u,D)=>w("div",{onClick:()=>{m(u.appointment??{})},className:"appointment text-[.8em]  absolute p-[2px] cursor-pointer",style:{height:u.height+"%",width:u.width+"%",left:u.left+"%",top:u.top+"%"},children:[c("div",{className:"appointment-conteiner rounded absolute",style:f(u).backgroundStyles}),c("div",{className:"sticky font-bold",style:f(u).titleStyles,children:c("div",{className:"appointment-title px-2 pt-1 hover:underline ",children:u.appointment.title})})]},u.appointment.title+"-"+D+u.top))}),n.map((u,D)=>c("div",{className:"date-time dark:border-gray-600 border-gray-300 border-t",style:{height:r+"px"}},D))]})},T))})},Y=e=>{const{blockHeight:s,timesArray:t}=e;return c("div",{className:"times text-[0.8em] w-10 pt-2",children:t.map((a,i)=>c("div",{className:"time  border-t border-transparent",style:{height:s+"px"},children:c("div",{className:"time-title  -mt-2",children:a})},i))})},N=e=>{const s=new Date;let t=0,a=0;const i=e.match(/^(\d{1,2})\s?(am|pm)$/i);i&&(t=parseInt(i[1]),i[2].toLowerCase()==="pm"&&t!==12&&(t+=12),i[2].toLowerCase()==="am"&&t===12&&(t=0));const n=e.match(/^(\d{1,2}):(\d{2})$/);return n&&(t=parseInt(n[1]),a=parseInt(n[2])),new Date(s.getFullYear(),s.getMonth(),s.getDate(),t,a,0)},C=(e,s)=>{const t=new Date(e);return t.setTime(t.getTime()+s*24*60*60*1e3),t},M=(e,s)=>{const t=new Date(e);return t.setTime(t.getTime()+s*7*24*60*60*1e3),t},P=(e,s,t,a)=>{const i=r=>{const m=r.getDay(),d=r.getDate()-m+(m===0?-6:1);return new Date(r.setDate(d))},n=(r,m)=>{const d=new Date(r);return d.setHours(m.getHours(),m.getMinutes(),0,0),d};if(a==="week"){const r=i(e),m=new Date(r);return m.setDate(r.getDate()+6),{start:n(r,s),end:n(m,t)}}else if(a==="day")return{start:n(e,s),end:n(e,t)}},B=(e,s,t,a)=>{const i=new Date(e.getTime()),n=new Date(s.getTime()),r=[];for(i.getTime()===n.getTime()&&n.setDate(n.getDate()+1);i<=n;)r.push(p(i,t)),i.setHours(i.getHours()+a);return r},E=(e,s)=>{const t=[],a=new Date,i=new Date(e.getTime()),n=i.getDay(),r=(n===0?-6:1)-n;if(i.setDate(i.getDate()+r),s==="day")return[{title:p(e,"DDD DD"),isSelect:e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth()&&e.getDate()===a.getDate(),date:e}];for(let m=0;m<7;m++){const d=p(i,"DDD DD");t.push({title:d,isSelect:i.getFullYear()===a.getFullYear()&&i.getMonth()===a.getMonth()&&i.getDate()===a.getDate(),date:new Date(i.getTime())}),i.setDate(i.getDate()+1)}return t},V=(e,s,t)=>e.filter(n=>(n.start=new Date(n.start),n.end=new Date(n.end),n.start.getTime()>=s.getTime()&&n.start.getTime()<=t.getTime()||n.end.getTime()>=s.getTime()&&n.end.getTime()<=t.getTime()||n.start.getTime()<s.getTime()&&n.end.getTime()>t.getTime())).sort((n,r)=>r.start-n.start),$=(e,s,t)=>{const a=new Date(s.getTime()),i=new Date(t.getTime());let n=new Array;for(;a.getTime()<i.getTime();){const r=new Date(a.getTime());r.setHours(i.getHours());const m=e.filter(o=>{const h=typeof o.start=="string"?new Date(o.start):o.start,g=typeof o.end=="string"?new Date(o.end):o.end;return h.getTime()>=a.getTime()&&h.getTime()<r.getTime()||g.getTime()>a.getTime()&&g.getTime()<=r.getTime()||h.getTime()<a.getTime()&&g.getTime()>r.getTime()});let d=[];m.forEach(o=>{const{top:h,height:g}=j(a,r,o.start,o.end);let f={start:o.start,end:o.end,appointment:o,top:h,left:null,width:null,height:g};d.push(f)});for(let o=0;o<d.length;o++)x(d[o],d);for(let o=0;o<d.length;o++)x(d[o],d);n.push(d),a.setDate(a.getDate()+1)}return n},j=(e,s,t,a)=>{const i=(s.getTime()-e.getTime())/1e3/60+60,n=t.getTime()<e.getTime()?0:(t.getTime()-e.getTime())/1e3/60,m=(a.getTime()>s.getTime()?i:(a.getTime()-e.getTime())/1e3/60)-n,d=n/i*100,o=m/i*100;return{top:d,height:o}},x=(e,s)=>{const t=I(e,s);if(t.length===0){e.left=0,e.width=100;return}const a=L(t);if(a)e.left=a.left,e.width=a.width;else{t.push(e);const i=100/t.length;t.forEach((n,r)=>{n.left=r*i,n.width=i})}},I=(e,s)=>s.filter(t=>e===t?!1:e.start.getTime()>=t.start.getTime()&&e.start.getTime()<t.end.getTime()||e.end.getTime()>t.start.getTime()&&e.end.getTime()<=t.end.getTime()||e.start.getTime()<t.start.getTime()&&e.end.getTime()>t.end.getTime()),L=e=>{e.sort((t,a)=>(t.left??0)-(a.left??0));let s=0;for(const t of e)if(t.left!==null){if(t.left>s)return{left:s,width:t.left-s};s=Math.max(s,t.left+(t.width??0))}return s<100?{left:s,width:100-s}:null},U=e=>{const{selectedDay:s,daysArray:t}=e;return w("div",{className:"scheduler-weekdays flex mt-2 border-b dark:border-gray-600 border-gray-300",children:[c("div",{className:"first-item w-10"}),c("div",{className:"weekdays text-center grid w-full",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map((a,i)=>c("div",{className:`weekday py-2 ${a.isSelect?"dark:bg-blue-900 bg-blue-300 rounded-t dark:text-white text-black":""}`,children:a.title},i))},t.length)]})},q=e=>{const s=l.useMemo(()=>N(e.startTime||"00:00"),[e.startTime]),t=l.useMemo(()=>N(e.endTime||"23:00"),[e.endTime]),a=l.useMemo(()=>e.onClickHandler||null,[e.onClickHandler]),i=l.useMemo(()=>e.setAppointmentStyle||null,[e.setAppointmentStyle]),n=e.viewType||"week",r=e.blockHeight||50,m=e.defaultAppointmentOpacity||.8,d=e.isHeader!==void 0?e.isHeader:!0,o=e.isDaysNames!==void 0?e.isDaysNames:!0,h=new Date,[g,f]=l.useState(new Date);l.useEffect(()=>{f(e.currentDate?new Date(e.currentDate):new Date)},[e.currentDate]);const[y,T]=l.useState(new Date),[u,D]=l.useState(new Date);l.useEffect(()=>{const k=P(g,s,t,n);k&&(T(k.start),D(k.end))},[g,s,t,n]);const b=B(s,t,"hh A",1),A=E(g,n),v=l.useMemo(()=>V(e.appointments||[],y,u),[e.appointments,y,u]),S=l.useMemo(()=>$(v,y,u),[v]),H=e.defaultAppointmentBgColor||"#1565c0",R=()=>{n==="week"&&f(M(g,-1)),n==="day"&&f(C(g,-1))},O=()=>{n==="week"&&f(M(g,1)),n==="day"&&f(C(g,1))},F=()=>{f(h)};return c("div",{className:"select-none",children:w("div",{className:"scheduler-container dark:bg-black rounded p-4",children:[d&&w("div",{className:"scheduler-header flex justify-between",children:[c("div",{className:"scheduler-date text-base",children:p(g,"MMMM YYYY")}),w("div",{className:"scheduler-nav flex gap-4",children:[c("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:R,children:"<"}),c("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:F,children:"Today"}),c("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:O,children:">"})]})]}),w("div",{className:"scheduler-body",children:[o&&c(U,{selectedDay:g,daysArray:A}),w("div",{className:"scheduler-dates flex relative",children:[c(Y,{timesArray:b,blockHeight:r}),c(W,{blockHeight:r,startTime:s,endTime:t,timesArray:b,daysArray:A,appointmentTiles:S,onAppointmentClick:a,defaultAppointmentOpacity:m,defaultAppointmentBgColor:H,setAppointmentStyle:i})]})]})]})})};export{q as A};
