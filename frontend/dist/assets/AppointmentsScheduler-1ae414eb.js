import{r as l,a as m,j as D,L as Y,n as b}from"./index-e5f80c0f.js";const L=e=>{const n=e.appointmentTiles||[],t=e.daysArray||[],a=e.defaultAppointmentOpacity,i=e.defaultAppointmentBgColor,s=e.timesArray||[];e.totalDuration;const r=e.blockHeight||50;e.onAppointmentClick;const d=e.setAppointmentStyle||null,c=l.useRef(null);l.useRef(0),l.useRef(0),l.useRef(!1),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(null),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(0),l.useRef(!1);const o=g=>{},y=()=>{},h=g=>{let f={backgroundColor:g.appointment.backgroundColor??i,inset:"1px",opacity:g.appointment.opacity??a},u={color:"#fff"},T={},w={};return d&&({extendedBackgroundStyles:T,extendedTitleStyle:w}=d(g.appointment)),f={...f,...T},u={...u,...w},{backgroundStyles:f,titleStyles:u}};return m("div",{className:"dates grid  w-full",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map((g,f)=>m("div",{className:"date pt-2 first:border-0 border-l dark:border-gray-600 border-gray-300",children:D("div",{className:"day-inner relative h-full",ref:c,children:[m("div",{className:"appointments-list overflow-hidden absolute h-full left-0 top-0 right-0",onMouseUp:y,onMouseMove:o,children:n[f]&&n[f].map((u,T)=>D(Y,{to:`/appointment/${u.appointment.id}`,className:"appointment text-[.8em]  absolute p-[2px] cursor-pointer",style:{height:u.height+"%",width:u.width+"%",left:u.left+"%",top:u.top+"%"},children:[m("div",{className:"appointment-conteiner rounded absolute",style:h(u).backgroundStyles}),m("div",{className:"sticky font-bold",style:h(u).titleStyles,children:m("div",{className:"appointment-title px-2 pt-1 hover:underline ",children:u.appointment.title})})]},u.appointment.title+"-"+T+u.top))}),s.map((u,T)=>m("div",{className:"date-time dark:border-gray-600 border-gray-300 border-t",style:{height:r+"px"}},T))]})},f))})},P=e=>{const{blockHeight:n,timesArray:t}=e;return m("div",{className:"times text-[0.8em] w-10 pt-2",children:t.map((a,i)=>m("div",{className:"time  border-t border-transparent",style:{height:n+"px"},children:m("div",{className:"time-title  -mt-2",children:a})},i))})},C=e=>{const n=new Date;let t=0,a=0;const i=e.match(/^(\d{1,2})\s?(am|pm)$/i);i&&(t=parseInt(i[1]),i[2].toLowerCase()==="pm"&&t!==12&&(t+=12),i[2].toLowerCase()==="am"&&t===12&&(t=0));const s=e.match(/^(\d{1,2}):(\d{2})$/);return s&&(t=parseInt(s[1]),a=parseInt(s[2])),new Date(n.getFullYear(),n.getMonth(),n.getDate(),t,a,0)},N=(e,n)=>{const t=new Date(e);return t.setTime(t.getTime()+n*24*60*60*1e3),t},M=(e,n)=>{const t=new Date(e);return t.setTime(t.getTime()+n*7*24*60*60*1e3),t},$=(e,n,t,a)=>{const i=r=>{const d=r.getDay(),c=r.getDate()-d+(d===0?-6:1);return new Date(r.setDate(c))},s=(r,d)=>{const c=new Date(r);return c.setHours(d.getHours(),d.getMinutes(),0,0),c};if(a==="week"){const r=i(e),d=new Date(r);return d.setDate(r.getDate()+6),{start:s(r,n),end:s(d,t)}}else if(a==="day")return{start:s(e,n),end:s(e,t)}},B=(e,n,t,a)=>{const i=new Date(e.getTime()),s=new Date(n.getTime()),r=[];for(i.getTime()===s.getTime()&&s.setDate(s.getDate()+1);i<=s;)r.push(b(i,t)),i.setHours(i.getHours()+a);return r},E=(e,n)=>{const t=[],a=new Date,i=new Date(e.getTime()),s=i.getDay(),r=(s===0?-6:1)-s;if(i.setDate(i.getDate()+r),n==="day")return[{title:b(e,"DDD DD"),isSelect:e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth()&&e.getDate()===a.getDate(),date:e}];for(let d=0;d<7;d++){const c=b(i,"DDD DD");t.push({title:c,isSelect:i.getFullYear()===a.getFullYear()&&i.getMonth()===a.getMonth()&&i.getDate()===a.getDate(),date:new Date(i.getTime())}),i.setDate(i.getDate()+1)}return t},V=(e,n,t)=>e.filter(s=>(s.start=new Date(s.start),s.end=new Date(s.end),s.start.getTime()>=n.getTime()&&s.start.getTime()<=t.getTime()||s.end.getTime()>=n.getTime()&&s.end.getTime()<=t.getTime()||s.start.getTime()<n.getTime()&&s.end.getTime()>t.getTime())).sort((s,r)=>r.start-s.start),j=(e,n,t)=>{const a=new Date(n.getTime()),i=new Date(t.getTime());let s=new Array;for(;a.getTime()<i.getTime();){const r=new Date(a.getTime());r.setHours(i.getHours());const d=e.filter(o=>{const y=typeof o.start=="string"?new Date(o.start):o.start,h=typeof o.end=="string"?new Date(o.end):o.end;return y.getTime()>=a.getTime()&&y.getTime()<r.getTime()||h.getTime()>a.getTime()&&h.getTime()<=r.getTime()||y.getTime()<a.getTime()&&h.getTime()>r.getTime()});let c=[];d.forEach(o=>{const{top:y,height:h}=I(a,r,o.start,o.end);let g={start:o.start,end:o.end,appointment:o,top:y,left:null,width:null,height:h};c.push(g)});for(let o=0;o<c.length;o++)x(c[o],c);for(let o=0;o<c.length;o++)x(c[o],c);s.push(c),a.setDate(a.getDate()+1)}return s},I=(e,n,t,a)=>{const i=(n.getTime()-e.getTime())/1e3/60+60,s=t.getTime()<e.getTime()?0:(t.getTime()-e.getTime())/1e3/60,d=(a.getTime()>n.getTime()?i:(a.getTime()-e.getTime())/1e3/60)-s,c=s/i*100,o=d/i*100;return{top:c,height:o}},x=(e,n)=>{const t=U(e,n);if(t.length===0){e.left=0,e.width=100;return}const a=G(t);if(a)e.left=a.left,e.width=a.width;else{t.push(e);const i=100/t.length;t.forEach((s,r)=>{s.left=r*i,s.width=i})}},U=(e,n)=>n.filter(t=>e===t?!1:e.start.getTime()>=t.start.getTime()&&e.start.getTime()<t.end.getTime()||e.end.getTime()>t.start.getTime()&&e.end.getTime()<=t.end.getTime()||e.start.getTime()<t.start.getTime()&&e.end.getTime()>t.end.getTime()),G=e=>{e.sort((t,a)=>(t.left??0)-(a.left??0));let n=0;for(const t of e)if(t.left!==null){if(t.left>n)return{left:n,width:t.left-n};n=Math.max(n,t.left+(t.width??0))}return n<100?{left:n,width:100-n}:null},q=e=>{const{selectedDay:n,daysArray:t}=e;return D("div",{className:"scheduler-weekdays flex mt-2 border-b dark:border-gray-600 border-gray-300",children:[m("div",{className:"first-item w-10"}),m("div",{className:"weekdays text-center grid w-full",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map((a,i)=>m("div",{className:`weekday py-2 ${a.isSelect?"dark:bg-blue-900 bg-blue-300 rounded-t dark:text-white text-black":""}`,children:a.title},i))},t.length)]})},J=e=>{const n=l.useMemo(()=>C(e.startTime||"00:00"),[e.startTime]),t=l.useMemo(()=>C(e.endTime||"23:00"),[e.endTime]),a=l.useMemo(()=>e.onClickHandler||null,[e.onClickHandler]),i=l.useMemo(()=>e.setAppointmentStyle||null,[e.setAppointmentStyle]),s=l.useMemo(()=>e.onCurrentDateChange||null,[e.onCurrentDateChange]),r=e.viewType||"week",d=e.blockHeight||50,c=e.defaultAppointmentOpacity||.8,o=e.isHeader!==void 0?e.isHeader:!0,y=e.isDaysNames!==void 0?e.isDaysNames:!0,h=new Date,[g,f]=l.useState(new Date);l.useEffect(()=>{f(e.currentDate?new Date(e.currentDate):new Date)},[e.currentDate]);const[u,T]=l.useState(new Date),[w,S]=l.useState(new Date);l.useEffect(()=>{const p=$(g,n,t,r);p&&(T(p.start),S(p.end)),s&&s(g)},[g,n,t,r]);const k=B(n,t,"hh A",1),A=E(g,r),v=l.useMemo(()=>V(e.appointments||[],u,w),[e.appointments,u,w]),H=l.useMemo(()=>j(v,u,w),[v]),R=e.defaultAppointmentBgColor||"#1565c0",O=()=>{r==="week"&&f(M(g,-1)),r==="day"&&f(N(g,-1))},F=()=>{r==="week"&&f(M(g,1)),r==="day"&&f(N(g,1))},W=()=>{f(h)};return m("div",{className:"select-none",children:D("div",{className:"scheduler-container dark:bg-black rounded p-4",children:[o&&D("div",{className:"scheduler-header flex justify-between",children:[m("div",{className:"scheduler-date text-base",children:b(g,"MMMM YYYY")}),D("div",{className:"scheduler-nav flex gap-4",children:[m("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:O,children:"<"}),m("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:W,children:"Today"}),m("button",{className:"btn btn-sm btn-outline btn-outline-primary",onClick:F,children:">"})]})]}),D("div",{className:"scheduler-body",children:[y&&m(q,{selectedDay:g,daysArray:A}),D("div",{className:"scheduler-dates flex relative",children:[m(P,{timesArray:k,blockHeight:d}),m(L,{blockHeight:d,startTime:n,endTime:t,timesArray:k,daysArray:A,appointmentTiles:H,onAppointmentClick:a,defaultAppointmentOpacity:c,defaultAppointmentBgColor:R,setAppointmentStyle:i})]})]})]})})};export{J as A};
