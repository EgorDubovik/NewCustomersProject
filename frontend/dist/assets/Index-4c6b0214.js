import{r as n,j as s,a as e,B as C,b as y,i as A,C as E,G as P,y as x,ab as B,P as M,a2 as I,F as L,c as j}from"./index-cca5a93b.js";const F=g=>{const h=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],k=[{time:"12:00 AM",value:0},{time:"1:00 AM",value:1},{time:"2:00 AM",value:2},{time:"3:00 AM",value:3},{time:"4:00 AM",value:4},{time:"5:00 AM",value:5},{time:"6:00 AM",value:6},{time:"7:00 AM",value:7},{time:"8:00 AM",value:8},{time:"9:00 AM",value:9},{time:"10:00 AM",value:10},{time:"11:00 AM",value:11},{time:"12:00 PM",value:12},{time:"1:00 PM",value:13},{time:"2:00 PM",value:14},{time:"3:00 PM",value:15},{time:"4:00 PM",value:16},{time:"5:00 PM",value:17},{time:"6:00 PM",value:18},{time:"7:00 PM",value:19},{time:"8:00 PM",value:20},{time:"9:00 PM",value:21},{time:"10:00 PM",value:22},{time:"11:00 PM",value:23}],[c,f]=n.useState(g.workingTime||{monday:{from:8,to:17},tuesday:{from:8,to:17},wednesday:{from:8,to:17},thursday:{from:8,to:17},friday:{from:8,to:17},saturday:{from:8,to:17},sunday:{from:8,to:17}}),[u,p]=n.useState(!1),b=t=>{const{name:r,value:a}=t.target,[l,w]=r.split("-");f(N=>({...N,[l]:{...N[l],[w]:Number(a)}}))},m=()=>{u||(p(!0),y.post("/company/settings/book-appointment/working-time",{workingTime:JSON.stringify(c)}).then(t=>{console.log(t.data)}).catch(t=>{console.log(t)}).finally(()=>{p(!1)}))};return s("div",{className:"panel p-4",children:[e("div",{className:"mt-1 text-center font-bold text-lg mb-4",children:"Working time"}),s("div",{className:"grid grid-flow-row gap-3",children:[h.map((t,r)=>s("div",{className:"grid grid-cols-3 gap-3",children:[e("label",{htmlFor:t.value,children:t.label}),e("select",{id:t.value,value:c[t.value].from,name:t.value+"-from",className:"form-select text-white-dark",onChange:b,children:k.map((a,l)=>e("option",{value:a.value,children:a.time},l))}),e("select",{id:t.value,value:c[t.value].to,name:t.value+"-to",className:"form-select text-white-dark",onChange:b,children:k.map((a,l)=>e("option",{value:a.value,children:a.time},l))})]},r)),e("div",{className:"mt-4 w-full",children:s("button",{className:"btn btn-primary w-full",onClick:m,children:["Save ",u&&e(C,{})]})})]})]})},O=g=>{const[h,k]=n.useState(g.settings),c=n.useRef(null),[f,u]=n.useState(!1),[p,b]=n.useState(!1),m=A(i=>i.themeConfig.companySettings.companyTags),[t,r]=n.useState(g.bookAppointmentTagsId),[a,l]=n.useState([]);n.useEffect(()=>{const i=m.filter(d=>t.includes(d.id));console.log("bookAppointmentTags:",i),l(i)},[t,m]);const w=()=>{var i,d;(i=c.current)==null||i.select(),navigator.clipboard&&navigator.clipboard.writeText(((d=c.current)==null?void 0:d.value)||"").then(()=>{P("Link copied successfully"),console.log("copied")}).catch(v=>{x("Failed to copy link"),console.log(v)})},N=i=>{u(!0),y.post("/company/settings/book-appointment/update",{active:i.target.checked}).then(d=>{console.log(d.data),k({...h,active:d.data.active})}).catch(d=>{console.log(d),x("Failed to update book appointment active status")}).finally(()=>{u(!1)})},o=i=>{const d=a;l(i),b(!0),y.post("/company/settings/book-appointment/tags",{tags:i.map(v=>v.id)}).then(v=>{console.log(v.data)}).catch(v=>{console.log(v),x("Failed to update book appointment tags"),l(d)}).finally(()=>{b(!1)})},S=i=>{const d=[...a,m.find(v=>v.id===i)];o(d)},T=i=>{const d=a.filter(v=>v.id!==i);o(d)};return e("div",{className:"panel p-4",children:s("div",{className:"mb-2",children:[e("div",{className:"mb-4",children:h.active?e("p",{className:"text-green-500",children:"Book appointment online is active"}):e("p",{className:"text-red-500",children:"Book appointment online is inactive"})}),s("div",{className:"flex items-center",children:[s("div",{className:"flex items-center",children:[s("label",{className:"w-12 h-6 relative mt-2",children:[e("input",{type:"checkbox",className:"custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer",id:"custom_switch_checkbox1",checked:h.active,onChange:N}),e("span",{className:"bg-[#ebedf2] dark:bg-dark block h-full rounded-full before:absolute before:left-1 before:bg-white dark:before:bg-white-dark dark:peer-checked:before:bg-white before:bottom-1 before:w-4 before:h-4 before:rounded-full peer-checked:before:left-7 peer-checked:bg-primary before:transition-all before:duration-300"})]}),f&&e("div",{className:"w-5 h-5 ml-2",children:e(C,{})})]}),s("div",{className:"flex w-full ml-10",children:[e("input",{disabled:!h.active,ref:c,readOnly:!0,id:"addonsRight",type:"text",placeholder:"",className:"form-input ltr:rounded-r-none rtl:rounded-l-none",value:window.location.origin+"/appointment/book/"+h.key}),e("button",{type:"button",className:"btn btn-secondary ltr:rounded-l-none rtl:rounded-r-none",onClick:w,children:e(E,{})})]})]}),s("div",{className:"grid grid-cols-2 mt-4",children:[s("div",{className:"border-r dark:border-gray-800 pr-2",children:["Choose a tag to link with this book appointment online:",e("div",{className:"flex flex-wrap gap-2 mt-2",children:m.map((i,d)=>a.find(v=>v.id===i.id)?null:e("button",{onClick:()=>S(i.id),className:"btn btn-sm border-none text-white shadow-none",style:{backgroundColor:i.color},children:i.title},d))})]}),s("div",{className:"pl-2",children:[s("div",{className:"flex items-center",children:["Selected tags: ",p&&e(C,{})]}),e("div",{className:"flex gap-2 mt-2",children:a.map((i,d)=>e("button",{onClick:()=>T(i.id),className:"btn btn-sm border-none text-white shadow-none",style:{backgroundColor:i.color},children:i.title},d))})]})]})]})})},W=g=>{const[h,k]=n.useState(g.loadedCompanyServices||[]),[c,f]=n.useState(g.bookService||[]),[u,p]=n.useState([]),b=t=>{let r=c.map(a=>a.id);r.push(t.id),y.post("/company/settings/book-appointment/update-services",{services:r}).then(a=>{console.log(a.data)}).catch(a=>{p([...u,t]),f(c.filter(l=>l.id!==t.id)),console.log(a)}),p(u.filter(a=>a.id!==t.id)),f([...c,t])},m=t=>{let r=c.map(a=>a.id);r=r.filter(a=>a!==t.id),y.post("/company/settings/book-appointment/update-services",{services:r}).then(a=>{console.log(a.data)}).catch(a=>{f([...c,t]),p(u.filter(l=>l.id!==t.id)),console.log(a)}),f(c.filter(a=>a.id!==t.id)),p([...u,t])};return n.useEffect(()=>{p(h.filter(t=>!c.some(r=>r.id===t.id)))},[]),s("div",{className:"grid grid-cols-2",children:[s("div",{className:"px-2",children:[e("p",{className:"my-2 mb-4",children:"Click to add"}),u.map((t,r)=>s("div",{className:"flex justify-between p-2 bg-slate-950 mt-2 rounded cursor-pointer",onClick:()=>{b(t)},children:[s("div",{children:[e("p",{className:"text-white",children:t.title}),e("p",{children:t.description})]}),e("div",{children:e("p",{className:"text-white",children:t.price})})]},r))]}),s("div",{className:"px-2 border-l dark:border-gray-800",children:[e("p",{className:"my-2 mb-4",children:"Click to remove"}),c.map((t,r)=>s("div",{className:"flex justify-between p-2 dark:bg-slate-950 bg-slate-100 mt-2 rounded cursor-pointer",onClick:()=>{m(t)},children:[s("div",{children:[e("p",{className:"dark:text-white",children:t.title}),e("p",{className:"text-gray-500",children:t.description})]}),e("div",{children:e("p",{className:"dark:text-white",children:t.price})})]},r))]})]})},_=()=>{const g=A(o=>o.themeConfig.rolesTitle),h=A(o=>o.themeConfig.rolesColor),[k,c]=n.useState(!0),[f,u]=n.useState(!1),[p,b]=n.useState([]),[m,t]=n.useState([]),[r,a]=n.useState([]);n.useEffect(()=>{c(!0),y.get("/company/settings/book-appointment/employees").then(o=>{console.log(o.data),b(o.data.employees),t(o.data.selectedEmployeesId||[]),a(o.data.selectedEmployeesId||[])}).catch(o=>{x("Something went wrong. Please try again later")}).finally(()=>{c(!1)})},[]);const l=!B(m,r),w=o=>{m.includes(o.id)?t(m.filter(S=>S!==o.id)):t([...m,o.id])},N=()=>{u(!0),y.post("/company/settings/book-appointment/employees",{selectedEmployeesId:m||[]}).then(o=>{a(m)}).catch(o=>{x("Something went wrong. Please try again later")}).finally(()=>{u(!1)})};return s("div",{children:[e("h1",{className:"text-base",children:"Specify who will receive the booking request"}),e("div",{className:"list-employees space-y-2 mt-4",children:k?e("div",{className:"flex items-center justify-center",children:e(M,{})}):p==null?void 0:p.map(o=>e("div",{className:"cursor-pointer bg-white dark:bg-[#1a294166] rounded-md shadow hover:shadow-lg",onClick:()=>w(o),children:e("div",{className:"p-4",children:s("div",{className:"flex items-center relative",children:[e("div",{className:"avatar",children:e("span",{className:"flex justify-center items-center w-10 h-10 text-center rounded-full object-cover bg-'bg-danger text-white",style:{backgroundColor:o.color},children:I(o.name)})}),s("div",{className:"ml-2 w-full overflow-hidden",children:[e("div",{className:"user-info",children:s("div",{className:"user-name w-full font-bold dark:text-white",children:[o.name,o.roles_ids.map((S,T)=>e("span",{className:`badge badge-outline-${h[S]} ml-2 text-[10px]`,children:g[S]},T))]})}),e("div",{className:"user-address mt-2 ml-1",children:o.phone})]}),e("div",{className:"flex items-center",children:e("input",{type:"checkbox",className:"form-checkbox",checked:m.includes(o.id),onChange:()=>{}})})]})})},o.id))}),e("div",{className:"update-status mt-4 flex items-center justify-end",children:l?s(L,{children:[e("p",{className:"text-gray-500 mr-2",children:"Unsaved changes"}),s("button",{type:"button",className:"btn btn-sm btn-primary",onClick:N,children:["Save ",f&&e(C,{})]})]}):e("p",{className:"text-gray-500 mr-2",children:"No changes"})}),e("div",{className:"mt-4",children:e("p",{className:"text-gray-500",children:" In case of no selection, request will be sent to admin"})})]})},R=()=>{const[g,h]=n.useState("loading"),[k,c]=n.useState({}),[f,u]=n.useState([]),[p,b]=n.useState([]),[m,t]=n.useState([]),[r,a]=n.useState({monday:{from:0,to:0},tuesday:{from:0,to:0},wednesday:{from:0,to:0},thursday:{from:0,to:0},friday:{from:0,to:0},saturday:{from:0,to:0},sunday:{from:0,to:0}});return n.useEffect(()=>{y.get("/company/settings/book-appointment").then(l=>{console.log(l.data),a(JSON.parse(l.data.settings.working_time)),c(l.data.settings),u(l.data.companyServices||[]),b(l.data.bookAppointmentServices||[]),t(l.data.bookAppointmentTagsId||[]),h("success")}).catch(l=>{console.log(l),h("error")})},[]),e("div",{children:s("div",{children:[e("div",{className:"flex justify-start items-center text-lg",children:e("h1",{children:"Book Appointments online settings"})}),g==="loading"&&e(M,{}),g==="error"&&e(j,{}),g==="success"&&e("div",{className:"py-4",children:s("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-5",children:[e(F,{workingTime:r}),s("div",{className:"md:col-span-2",children:[e(O,{settings:k,bookAppointmentTagsId:m}),e("div",{className:"panel p-2 mt-5 pb-4",children:e(W,{loadedCompanyServices:f,bookService:p})})]}),e("div",{className:"panel",children:e(_,{})})]})})]})})};export{R as default};
