import{r as s,b as t,F as W,a as D,u as X,f as Y,y as Z,j as a,B as ee,t as A,_ as H,m as B}from"./index-34d491a9.js";import{a as te,T as P,S as se}from"./ServicesList-94335194.js";import{h as y}from"./moment-a9aaa855.js";import{I as ae}from"./IconEdit-4fa80ea5.js";import"./IconPlus-8c7cce23.js";import"./IconCopy-1bc2fa0b.js";const re=T=>{const[b,d]=s.useState(0),[u,c]=s.useState([]),{modal:f,setModal:l,techsIds:m,onAddRemovetechFromList:x,onSaveTeachs:N,onRemoveTech:n}=T,[p,k]=s.useState([]),v=()=>{D.get("company/techs").then(r=>{c(r.data.techs)}).catch(r=>{console.log(r)}).finally(()=>{})};return s.useEffect(()=>{v()},[]),s.useEffect(()=>{k(u.filter(r=>m.includes(r.id))),d(0)},[m,u]),t(W,{children:t(te,{techs:p,companyTechs:u,modal:f,setModal:l,techsIds:m,removeTech:r=>{d(r),n(r)},removeTechStatus:b,addRemovetechFromList:r=>{x(r)},saveNewTechs:()=>{N()}})})},me=()=>{var E;const T=X(),b=()=>{const e=new Date;return e.getMinutes()>45&&e.getMinutes()<=59&&(e.setHours(e.getHours()+1),e.setMinutes(0),e.setSeconds(0)),e},[d,u]=s.useState(b()),[c,f]=s.useState(new Date(new Date().getTime()+60*120*1e3)),[l,m]=s.useState("timeFrom"),[x,N]=s.useState(!1),[n,p]=s.useState([]),[k,v]=s.useState(!1),[w,S]=s.useState(!1),[C,r]=s.useState(!1),[M,j]=s.useState(!1),L=Y(e=>e.themeConfig.user.id),_=e=>{p(n.filter(o=>o.id!==e))},z=e=>{e.id=n.length+1,p([...n,e]),v(!1)},{customerId:I}=Z(),[i,F]=s.useState({id:0,name:"Unknown",phone:"+1 123 456 7890",idAddress:0,addresses:[]});s.useEffect(()=>{D.get(`customers/${I}`).then(e=>{F({id:e.data.id,name:e.data.name,phone:e.data.phone,addresses:e.data.address,idAddress:0})}).catch(e=>{console.log(e)}).finally(()=>{})},[]);const O=e=>{console.log("time from:",e),u(new Date(e)),x||f(new Date(e.getTime()+60*120*1e3))},U=e=>{N(!0),f(new Date(e))},[$,R]=s.useState(!1),[h,g]=s.useState([]),q=e=>h.includes(e),G=e=>{g(h.filter(o=>o!==e))},J=e=>{q(e)?g(h.filter(o=>o!==e)):g([...h,e])},K=()=>{R(!1)};s.useEffect(()=>{g([L])},[L]);const Q=e=>{F({...i,idAddress:e}),r(!1)},V=()=>{M||(j(!0),D.post("appointment",{timeFrom:B(d),timeTo:B(c),services:n,techs:h,customerId:I,addressId:i.addresses[i.idAddress].id||0}).then(e=>{e.status===200&&T("/appointment/"+e.data.appointment.id)}).catch(e=>{console.log(e),alert("Error, please try again")}).finally(()=>{j(!1)}))};return a("div",{children:[t("div",{className:"flex items-center justify-center flex-wrap gap-4 my-4 md:my-0 md:justify-start",children:t("h2",{className:"text-xl",children:"Create appointment"})}),t("div",{className:"conteiner w-full md:w-1/3 m-auto",children:a("div",{className:"panel",children:[a("div",{className:"mb-5 relative",children:[t("div",{className:"border-b border-[#ebedf2] dark:border-[#1b2e4b] bg-gray-800 px-2 rounded-t",children:a("div",{className:"flex items-center justify-between py-3",children:[a("h6",{className:"text-[#515365] font-bold dark:text-white-dark text-[15px]",children:[i.name,t("span",{className:"block text-white-dark dark:text-white-light font-normal text-xs mt-1",children:(E=i.addresses[i.idAddress])==null?void 0:E.full})]}),t("div",{className:"h-full p-2 cursor-pointer rounded hover:dark:bg-white-dark/10 hover:bg-gray-100",onClick:()=>r(!C),children:t(ae,{})})]})}),t("div",{className:"absolute "+(C?"":"hidden")+" left-0 right-0 top-17 bg-gray-800 py-4 rounded-b z-50",children:i.addresses.map((e,o)=>t("div",{className:"address-list p-4 hover:bg-gray-900 cursor-pointer",onClick:()=>Q(o),children:e.full},o))})]}),a("div",{className:"mt-5",children:[a("div",{className:"mb-5 flex justify-center bg-gray-100 dark:bg-white-dark/10 rounded p-2",children:[a("div",{onClick:()=>m("timeFrom"),className:"w-1/2 timeFrom flex justify-center items-center cursor-pointer py-3 rounded "+(l==="timeFrom"?"dark:bg-black/25 dark:text-white font-bold bg-gray-200":""),children:[t("div",{children:"From:"}),a("div",{className:"ml-10 text-center",children:[t("div",{children:y(d).format("MMM DD")}),t("div",{children:y(d).format("hh:mm A")})]})]}),a("div",{onClick:()=>m("timeTo"),className:"w-1/2 timeFrom flex justify-center items-center cursor-pointer py-3 rounded "+(l==="timeTo"?"dark:bg-black/25 dark:text-white font-bold bg-gray-200":""),children:[t("div",{children:"To:"}),a("div",{className:"ml-10 text-center",children:[t("div",{children:y(c).format("MMM DD")}),t("div",{children:y(c).format("hh:mm A")})]})]})]}),a("div",{className:"text-[16px] dark:text-white text-right",children:[l==="timeFrom"&&t(P,{currentDate:d,options:{itemsHeight:45,textAlign:"right",borderColor:"#077afe"},onDateChange:O}),l==="timeTo"&&t(P,{currentDate:c,options:{itemsHeight:45,daysNameFormat:"MMM DD, DDDD",borderColor:"#077afe"},onDateChange:U})]})]}),a("div",{className:"mt-5",children:[t("h2",{children:"Add services"}),t("div",{className:"mt-5",children:t(se,{services:n,onRemoveService:_,onSaveService:z,modal:k,setModal:v})})]}),a("div",{className:"mt-5",children:[t("h2",{children:"Add Technical"}),t("div",{className:"mt-5",children:t(re,{techsIds:h,onRemoveTech:G,modal:$,setModal:R,onAddRemovetechFromList:J,onSaveTeachs:K})})]}),t("div",{className:"mt-8",children:t("button",{onClick:V,className:"btn btn-primary w-full",children:M?a("div",{children:["Loading...",t(ee,{})]}):"Create appointment"})})]})}),t(A,{appear:!0,show:w,as:s.Fragment,children:a(H,{as:"div",open:w,onClose:()=>S(!1),children:[t(A.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t("div",{className:"fixed inset-0"})}),t("div",{id:"login_modal",className:"fixed inset-0 bg-[black]/60 z-[999] overflow-y-auto",children:t("div",{className:"flex items-start justify-center min-h-screen px-4",children:t(A.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t(H.Panel,{className:"panel border-0 py-1 px-4 rounded-lg overflow-hidden w-full max-w-lg my-8 text-black dark:text-white-dark",children:t("div",{className:"p-4",children:t("ul",{className:"list-group",children:i.addresses.map((e,o)=>t("li",{className:"px-2 py-4  mb-2 flex items-center  "+(i.idAddress===o?"dark:bg-[#050b14] text-primary":"hover:dark:bg-white-dark/10")+" "+(i.idAddress===o?"bg-gray-100 text-primary":"hover:bg-gray-200")+" rounded cursor-pointer",onClick:()=>{F({...i,idAddress:o}),S(!1)},children:t("div",{className:"flex-grow ml-4 text-sm",children:t("p",{className:"font-semibold",children:e.full})})},o))})})})})})})]})})]})};export{me as default};
