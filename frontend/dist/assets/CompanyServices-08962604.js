import{d as M,r as i,s as q,j as a,b as e,z as B,A as U,S as _,t as b,_ as P,B as X,a as u,as as F}from"./index-1e548eae.js";import{I as $}from"./IconPlus-73e05361.js";import{I as G}from"./IconX-fce78c7b.js";const O=()=>{const T=M();i.useEffect(()=>{T(q("Company Services"))});const[f,g]=i.useState("loading"),[x,d]=i.useState(!1),[r,m]=i.useState([]),[N,c]=i.useState(!1),[s,v]=i.useState({id:null,title:"",description:"",price:""}),[S,w]=i.useState(!1),[C,k]=i.useState(!1),[h,D]=i.useState([]),[j,E]=i.useState(0),A=()=>{g("loading"),u.get("company/settings/services").then(t=>{D(t.data.userRols),m(t.data.services),g("success")}).catch(t=>{console.error("Error:",t),g("error")})};i.useEffect(()=>{A()},[]);const L=()=>{v({id:null,title:"",description:"",price:""}),c(!0)},y=t=>{t.target.name==="title"&&S&&w(!1),t.target.name==="price"&&C&&k(!1),v({...s,[t.target.name]:t.target.value})},R=()=>{var t,l;if(!x){let n=!1;if((t=s.title)!=null&&t.trim()||(w(!0),n=!0),(l=s.price)!=null&&l.trim()||(k(!0),n=!0),n)return;s.id?(d(!0),u.put("company/settings/services/"+s.id,s).then(o=>{c(!1);for(let p=0;p<r.length;p++)if(r[p].id===s.id){r[p]=s;break}m([...r])}).catch(o=>{console.error("Error:",o),F("Somthing went wrong. Please try again.","error")}).finally(()=>{d(!1)})):(d(!0),u.post("company/settings/services",s).then(o=>{c(!1),r.unshift(o.data.service),m([...r])}).catch(o=>{console.error("Error:",o),F("Somthing went wrong. Please try again.","error")}).finally(()=>{d(!1)}))}},I=t=>{for(let l=0;l<r.length;l++)if(r[l].id===t){v(r[l]);break}c(!0)},z=t=>{E(t),u.delete("company/settings/services/"+t).then(l=>{for(let n=0;n<r.length;n++)if(r[n].id===t){r.splice(n,1),m([...r]);break}}).catch(l=>{alert("Somthing went wrong. Please try again."),console.error("Error:",l)}).finally(()=>{E(0)})};return a("div",{children:[f==="loading"&&e(B,{}),f==="error"&&e(U,{}),f==="success"&&a("div",{children:[a("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e("h2",{className:"text-xl",children:"Company services"}),e("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:e("div",{className:"flex gap-3",children:e("div",{children:(h.includes("Admin")||h.includes("Dispatcher"))&&a("button",{type:"button",className:"btn btn-primary",onClick:()=>L(),children:[e($,{className:"ltr:mr-2 rtl:ml-2"}),"Add New service"]})})})})]}),e("div",{className:"panel mt-5 p-0 border-0 w-2/3 m-auto",children:e("div",{className:"table-responsive",children:a("table",{className:"table-striped table-hover",children:[e("thead",{children:a("tr",{children:[e("th",{className:"text-gray-400",children:"Title"}),e("th",{className:"text-gray-400",children:"Description"}),e("th",{className:"text-gray-400",children:"Price"}),e("th",{className:"!text-center text-gray-400",children:"Actions"})]})}),e("tbody",{children:r.map((t,l)=>a("tr",{children:[e("td",{children:e("div",{className:"flex items-center w-max",children:e("div",{className:"font-bold",children:t.title})})}),e("td",{children:t.description}),a("td",{className:"whitespace-nowrap",children:["$",t.price]}),e("td",{children:h.includes("Admin")||h.includes("Dispatcher")?a("div",{className:"flex gap-4 items-center justify-end",children:[e("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>I(t.id),children:"Edit"}),e("button",{type:"button",className:"btn btn-sm btn-outline-danger w-20",onClick:()=>z(t.id),children:j===t.id?e(_,{}):"Delete"})]}):e("div",{className:"text-gray-400 text-center",children:"No action"})})]},l))})]})})})]}),e(b,{appear:!0,show:N,as:i.Fragment,children:a(P,{as:"div",open:N,onClose:()=>c(!1),className:"relative z-[51]",children:[e(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(P.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>c(!1),className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e(G,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:s.id?"Edit Service":"Add Service"}),e("div",{className:"p-5",children:a("form",{children:[a("div",{className:"mb-5 "+(S?"has-error":""),children:[e("label",{htmlFor:"name",children:"Title"}),e("input",{id:"title",name:"title",value:s.title,type:"text",placeholder:"Enter Title",className:"form-input",onChange:t=>{y(t)}})]}),a("div",{className:"mb-5 "+(C?"has-error":""),children:[e("label",{htmlFor:"email",children:"Price"}),e("input",{id:"price",name:"price",value:s.price,type:"number",placeholder:"Enter price",className:"form-input",onChange:t=>{y(t)}})]}),a("div",{className:"mb-5",children:[e("label",{htmlFor:"address",children:"Description"}),e("textarea",{name:"description",value:s.description,rows:2,placeholder:"Enter Description",className:"form-textarea resize-none min-h-[70px]",onChange:t=>{y(t)}})]}),a("div",{className:"flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>c(!1),children:"Cancel"}),a("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:R,children:[s.id?"Update":"Save",x&&e("div",{role:"status",children:e(X,{})})]})]})]})})]})})})})]})})]})};export{O as default};
