import{r as s,e as R,h as A,b as P,a5 as j,M as L,j as n,a as e,R as B,V as T,P as $,c as Q,F as V,Q as Y,g as z,B as _,t as q,_ as M}from"./index-d9a8e77f.js";import{I as H}from"./IconX-7253e031.js";const O=()=>{const[I,h]=s.useState("loading"),[d,p]=s.useState(!1),[E,c]=s.useState(!1),[l,o]=s.useState([]),[i,b]=s.useState({id:0,title:"",quantity:0,expexted_quantity:0}),[C,x]=s.useState(0),y=R(),F=A(a=>a.themeConfig.sideBarNotifications);s.useEffect(()=>{h("loading"),P.get("/storage").then(a=>{console.log("data:",a.data),o(a.data.storageItems),h("success")}).catch(a=>{h("error"),console.log(a)})},[]),s.useEffect(()=>{const a=l.filter(r=>r.quantity<r.expexted_quantity).length;y(j({...F,storage:a}))},[l]);const v=()=>{d||(i.id!==0?N(i.id):(p(!0),P.post("/storage",i).then(a=>{a.status===200&&c(!1),a.data.allStorageItems&&o(a.data.allStorageItems)}).catch(a=>{console.log(a)}).finally(()=>{p(!1)})))},N=a=>{d||(p(!0),P.put(`/storage/${a}`,i).then(r=>{r.status===200&&c(!1);const m=l.findIndex(D=>D.id===a),u=[...l];u[m]=r.data.storageItem,o(u)}).catch(r=>{console.log(r)}).finally(()=>{p(!1)}))};return{openModal:a=>{if(a===0)b({id:0,title:"",quantity:0,expexted_quantity:0});else{const r=l.find(m=>m.id===a);b(r)}c(!0)},modal:E,setModal:c,removeItem:a=>{C===0&&(console.log("removeID:",a),x(a),P.delete(`/storage/${a}`).then(r=>{if(r.status===200){const m=l.filter(u=>u.id!==a);o(m)}}).catch(r=>{console.log(r)}).finally(()=>{x(0)}))},storeItem:v,changeValue:a=>{b({...i,[a.target.name]:a.target.value})},loadingDataForm:d,initialRecords:l,dataForm:i,loadingStatus:I,updateItem:N,removeId:C}},X=()=>{const{openModal:I,modal:h,setModal:d,removeItem:p,storeItem:E,changeValue:c,dataForm:l,initialRecords:o,loadingStatus:i,loadingDataForm:b,removeId:C}=O(),[x,y]=s.useState([]),F=[10,20,30,50,100],[v,N]=s.useState(1),[g,k]=s.useState(F[0]),[S,a]=s.useState({columnAccessor:"firstName",direction:"asc"}),[r,m]=s.useState(""),u=t=>{const f=(v-1)*g,w=f+g;return t.slice(f,w)};return s.useEffect(()=>{N(1)},[g]),s.useEffect(()=>{const t=u(L(o,S.columnAccessor));y(S.direction==="desc"?t.reverse():t)},[S,o]),s.useEffect(()=>{y(u(o))},[v,g]),n("div",{children:[n("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e("h2",{className:"text-xl",children:"Storage"}),n("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:[e("div",{className:"flex gap-3",children:e("div",{children:n("button",{type:"button",className:"btn btn-primary",onClick:()=>{I(0)},children:[e(B,{className:"ltr:mr-2 rtl:ml-2"}),"Add Item"]})})}),n("div",{className:"relative",children:[e("input",{type:"text",placeholder:"Search Item",className:"form-input py-2 pr-11 peer",value:r,onChange:t=>{m(t.target.value);const f=o.filter(w=>w.title.toLowerCase().includes(t.target.value.toLowerCase()));y(f)}}),e("button",{type:"button",className:"absolute right-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:e(T,{className:"mx-auto"})})]})]})]}),i==="loading"&&e($,{}),i==="error"&&e("div",{className:"mt-4",children:e(Q,{})}),i==="success"&&e(V,{children:x.length===0?e("div",{className:"mt-4",children:e("div",{className:"flex items-center justify-center",children:n("div",{className:"text-center",children:[e("h2",{className:"text-xl",children:"No Items Found"}),e("p",{className:"text-gray-500",children:"Add new items to the storage"})]})})}):e("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:e("div",{className:"datatables pagination-padding",children:e(Y,{className:"whitespace-nowrap table-hover invoice-table pb-4",records:x,columns:[{accessor:"ID",sortable:!0,render:({id:t})=>e("span",{children:t})},{accessor:"title",sortable:!0,render:({title:t})=>e("span",{children:t})},{accessor:"quantity",sortable:!0,render:({quantity:t})=>e("span",{children:t})},{accessor:"expexted_quantity",sortable:!0,render:({expexted_quantity:t})=>e("span",{children:t})},{accessor:"updated_at",sortable:!0,render:({updated_at:t})=>e("span",{children:z(new Date(t),"MMMM DD, YYYY")})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:({id:t})=>n("div",{className:"flex gap-4 items-center w-max mx-auto",children:[e("button",{type:"button",className:"btn btn-sm btn-outline-warning",onClick:()=>{I(t)},children:"Edit"}),n("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>{p(t)},children:["Delete ",C===t&&e(_,{})]})]})}],highlightOnHover:!0,totalRecords:o.length,recordsPerPage:g,page:v,onPageChange:t=>N(t),recordsPerPageOptions:F,onRecordsPerPageChange:k,sortStatus:S,onSortStatusChange:a,paginationText:({from:t,to:f,totalRecords:w})=>`Showing  ${t} to ${f} of ${w} entries`})})})}),e(q,{appear:!0,show:h,as:s.Fragment,children:n(M,{as:"div",open:h,onClose:()=>d(!1),className:"relative z-[51]",children:[e(q.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(q.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:n(M.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>d(!1),className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e(H,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:l.id?"Edit Contact":"Add Contact"}),e("div",{className:"p-5",children:n("form",{children:[n("div",{className:"mb-5",children:[e("label",{htmlFor:"name",children:"Title"}),e("input",{id:"title",type:"text",name:"title",placeholder:"Enter Name",className:"form-input",value:l.title,onChange:t=>c(t)})]}),n("div",{className:"flex gap-4",children:[n("div",{className:"mb-5 w-1/2",children:[e("label",{htmlFor:"email",children:"Quantity"}),e("input",{id:"quantity",type:"number",name:"quantity",placeholder:"Enter Email",className:"form-input",value:l.quantity,onChange:t=>c(t)})]}),n("div",{className:"mb-5 w-1/2",children:[e("label",{htmlFor:"number",children:"Expected Quantity"}),e("input",{id:"expexted_quantity",type:"number",name:"expexted_quantity",placeholder:"Enter Phone Number",className:"form-input",value:l.expexted_quantity,onChange:t=>c(t)})]})]}),n("div",{className:"flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>d(!1),children:"Cancel"}),n("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:E,children:[l.id?"Update":"Add",b&&e(_,{})]})]})]})})]})})})})]})})]})};export{X as default};
