import{N as L,r,b as P,j as s,F as M,a as e,P as T,c as S,L as d,A as _,m as E,C as $,I as J,H as b,o as V,v as g,h as A,M as D,G as k,y as C}from"./index-cca5a93b.js";import{I as F}from"./IconPhone-872c37c2.js";import{I}from"./IconCalendar-81fb28af.js";const Y=()=>{const{id:t}=L(),[n,c]=r.useState({}),[m,o]=r.useState("loading"),[h,p]=r.useState([]);return r.useEffect(()=>{P.get(`/customers/${t}`).then(i=>{o("success"),p(i.data.companyTags),c(i.data.customer)}).catch(i=>{o("error"),console.log(i)}).finally(()=>{console.log("finally")})},[]),{customer:n,loadingStatus:m,companyTags:h}},q=()=>{var i,f,x,u;const{customer:t,loadingStatus:n}=Y(),[c,m]=r.useState(3),o=a=>{navigator.clipboard.writeText(a).then(()=>{k("Phone number copied to clipboard")}).catch(l=>{C("Failed to copy phone number")})},h=a=>{window.confirm("Are you sure you want to remove this job?")&&P("job/"+a,{method:"DELETE"}).then(l=>{k("Job removed successfully"),window.location.reload()}).catch(l=>{C("Failed to remove job")})},p=()=>{};return console.log("CUSTOMER:",t),s(M,{children:[n==="loading"&&e(T,{}),n==="error"&&e(S,{}),n==="success"&&e("div",{className:"py-4",children:s("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s("div",{className:"panel p-0",children:[s("div",{className:"flex items-center justify-between p-4",children:[e("h3",{className:"font-semibold text-lg dark:text-white-light",children:"Customer"}),e(d,{to:"/customer/update/"+(t.id??0)+"?redirectTo="+window.location.pathname,className:"ltr:ml-auto rtl:mr-auto btn btn-primary p-2 rounded-full",children:e(_,{className:"w-4 h-4"})})]}),s("div",{className:"mb-1",children:[s("div",{className:"flex flex-col justify-center items-center ",children:[e("div",{className:"w-full h-[250px] dark:bg-gray-800 bg-gray-200 flex items-center justify-center",children:"No Location found"}),e("p",{className:"font-semibold text-primary text-lg mt-4",children:t==null?void 0:t.name})]}),e("div",{className:"px-4 pb-4",children:s("ul",{className:"mt-5 flex flex-col m-auto space-y-4 font-semibold text-white-dark",children:[(i=t==null?void 0:t.address)==null?void 0:i.map((a,l)=>s("li",{className:"flex items-center gap-2",children:[e(E,{className:"shrink-0"}),e("a",{href:`https://www.google.com/maps?q=${encodeURIComponent(a.full)}`,target:"_blank",rel:"noopener noreferrer",children:a==null?void 0:a.full})]},l)),s("li",{className:"flex justify-between",children:[s("div",{className:"flex gap-2",children:[e(F,{}),e("span",{className:"whitespace-nowrap",dir:"ltr",children:e("a",{href:`tel:${t.phone}`,children:t==null?void 0:t.phone})})]}),e("button",{onClick:()=>o(t.phone||""),children:e($,{className:"text-primary cursor-pointer"})})]}),e("li",{children:s("div",{className:"flex gap-2",children:[e(J,{className:"w-5 h-5 shrink-0"}),e("span",{className:"text-primary truncate",children:t==null?void 0:t.email})]})})]})})]})]}),s("div",{className:"grid grid-cols-1 gap-3",children:[s("div",{className:"panel p-4",children:[s("div",{className:"flex items-center justify-between",children:[s("h3",{className:"font-semibold text-lg dark:text-white-light",children:["Jobs history (",t.jobs.length,")"]}),e(d,{to:`/appointment/create/${t.id}`,className:"ltr:ml-auto rtl:mr-auto btn btn-primary p-2 rounded-full",children:e(b,{className:"w-4 h-4"})})]}),s("div",{className:"appointments-list py-4",children:[(f=t==null?void 0:t.jobs)==null?void 0:f.slice(0,c).map((a,l)=>{var N,w,v,y;return a.appointments.length>0?e(d,{to:`/appointment/${a.appointments[a.appointments.length-1].id}`,children:s("div",{className:"p-2 shadow bg-[#f4f4f4] dark:bg-white-dark/20 rounded border-l-2 mb-3",style:{borderColor:V(a.appointments[a.appointments.length-1])},children:[s("div",{className:"px-4 flex items-center justify-between",children:[s("div",{className:"min-w-0 flex-1",children:[e("p",{className:"font-bold dark:text-gray-300",children:(N=a==null?void 0:a.services[0])==null?void 0:N.title}),e("p",{className:"whitespace-nowrap overflow-hidden text-ellipsis",children:(w=a==null?void 0:a.services[0])==null?void 0:w.description})]}),e("div",{className:`text-${a.remaining_balance>0?"danger":"success"} text-center text-[12px]`,children:g(a.remaining_balance>0?a.remaining_balance:a.total_paid)})]}),s("div",{className:"flex items-center justify-between px-4 mt-2",children:[s("div",{className:"flex items-center",children:[e(I,{className:"w-4 h-4"}),e("span",{className:"ml-2",children:A(a.appointments[a.appointments.length-1].start,"MMM DD, YYYY")})]}),s("div",{className:"",children:[a.appointments.length," Visits"]})]})]})},l):s("div",{className:"p-2 shadow bg-[#f4f4f4] dark:bg-white-dark/20 rounded border-l-2 mb-3 border-gray-500",children:[s("div",{className:"px-4 flex items-center justify-between w-full ",children:[s("div",{children:[e("p",{className:"font-bold dark:text-gray-300",children:(v=a==null?void 0:a.services[0])==null?void 0:v.title}),e("p",{className:"w-full max-w-xs whitespace-nowrap overflow-hidden text-ellipsis",children:(y=a==null?void 0:a.services[0])==null?void 0:y.description})]}),a.remaining_balance>0?e("div",{className:"text-danger text-center text-[12px]",children:g(a.remaining_balance)}):e("div",{className:"text-success text-center text-[12px]",children:g(a.total_paid)})]}),s("div",{className:"flex items-center justify-between px-4 mt-2",children:[s("div",{className:"flex items-center",children:[e(I,{className:"w-4 h-4"}),e(d,{to:`/appointment/create/${t.id}?job_id=${a.id}`,className:"ml-2 text-primary",children:"Create appointment"})]}),s("div",{className:"cursor-pointer text-danger flex",onClick:()=>{h(a.id)},children:[e(D,{className:"mr-2"}),"Remove job"]})]})]},l)}),((x=t==null?void 0:t.jobs)==null?void 0:x.length)>c&&e("div",{className:"border-t border-white-light dark:border-white/10",children:s("div",{onClick:()=>{m(t.jobs.length)},className:"cursor-pointer group group flex items-center justify-center p-4 font-semibold hover:text-primary",children:["View All ",t.jobs.length," Jobs",e("svg",{className:"h-4 w-4 transition duration-300 group-hover:translate-x-1 ltr:ml-1 rtl:mr-1 rtl:rotate-180 rtl:group-hover:-translate-x-1",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M4 12H20M20 12L14 6M20 12L14 18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})})]})})]})]}),s("div",{className:"panel",children:[s("div",{className:"flex items-center justify-between",children:[e("h3",{className:"font-semibold text-lg dark:text-white-light",children:"Tags"}),e("button",{className:"btn btn-primary p-2 rounded-full",onClick:p,children:e(b,{className:"w-4 h-4"})})]}),e("div",{className:"teags-list",children:(u=t==null?void 0:t.tags)==null?void 0:u.map((a,l)=>e("div",{className:"tag-item",children:e("span",{className:"text-primary",children:a.name})},l))})]})]}),e("div",{className:"panel"})]})})]})};export{q as default};
